# FaceIdentify 人脸识别系统

## 项目概述
本项目实现了一个基于BP神经网络和支持向量机(SVM)的人脸识别系统，使用CASIA-FaceV5人脸数据集进行训练和测试。系统提供完整的机器学习流程，包括数据预处理、模型训练、性能评估和结果可视化，旨在提供一个简单而有效的人脸识别解决方案。

## 功能特性
- 支持BP神经网络和SVM两种经典分类算法
- 完整的数据集自动划分功能
- 精确的人脸图像预处理
- 详细的训练过程日志和损失监控
- 多维度模型性能评估
- 算法性能对比分析
- 直观的训练结果可视化展示
- 支持中文显示的图表输出

## 技术架构

### 核心算法
- **BP神经网络**：包含输入层、隐藏层和输出层的三层前馈神经网络，使用sigmoid激活函数和softmax输出层
- **支持向量机(SVM)**：使用RBF核函数，支持概率输出

### 图像处理流程
- 图像读取与RGB转换
- 尺寸归一化(32×32)
- 像素值标准化(0-1)
- 特征扁平化

### 模型评估指标
- 准确率(Accuracy)
- 损失函数值
- 训练时间
- 混淆矩阵

## 安装要求

### 环境要求
- Python 3.6+ 
- 操作系统：Windows/Linux/MacOS

### 依赖库
```
numpy==1.20.3
matplotlib==3.4.3
scikit-learn==1.0.2
pillow==8.3.2
```

### 安装方法
1. 克隆或下载项目到本地
2. 安装依赖库
   ```bash
   pip install -r requirements.txt
   ```

## 项目结构
```
FaceIdentify/
├── 64_CASIA-FaceV5/      # 人脸数据集，包含180个类别的人脸图像
├── src/                  # 源代码目录
│   ├── data/             # 数据处理模块
│   ├── plotting/         # 结果可视化模块
│   ├── training/         # 模型训练模块
│   ├── testing/          # 模型测试模块
│   └── utils/            # 工具函数
├── labels/               # 标签文件目录
│   └── classes.json      # 类别名称文件
├── results/              # 结果存储目录
│   ├── comparison/       # 模型比较结果
│   └── plots/            # 图表结果
├── plots/                # 临时图表和日志
├── main.py               # 主程序入口
├── requirements.txt      # 项目依赖
└── README.md             # 项目说明文档
```

## 使用方法

### 基本使用
1. 确保数据集已正确放置在`64_CASIA-FaceV5/`目录下
2. 运行主程序
   ```bash
   python main.py
   ```
3. 程序将自动执行以下流程：
   - 数据集划分
   - BP神经网络训练
   - BP神经网络测试
   - SVM模型训练与测试
   - 模型性能比较
   - 结果可视化

### 自定义配置
可以通过修改代码中的参数来调整模型配置：
- BP神经网络参数（隐藏层大小、学习率、训练轮数等）
- SVM参数（C值、核函数类型、gamma参数等）
- 图像预处理参数（图像大小等）

## 算法说明

### BP神经网络
BP神经网络是一种按误差反向传播算法训练的多层前馈网络，本项目实现的网络结构如下：
- 输入层：32×32×3=3072个神经元（对应预处理后的图像特征）
- 隐藏层：128个神经元，使用sigmoid激活函数
- 输出层：180个神经元（对应数据集中的180个类别），使用softmax激活函数

训练过程采用小批量梯度下降法，损失函数使用交叉熵损失。

### SVM分类器
支持向量机是一种二分类模型，通过核函数技巧可以扩展到多分类问题。本项目中使用：
- RBF核函数
- C=1.0的正则化参数
- gamma='scale'的核系数设置

## 数据集说明
本项目使用CASIA-FaceV5人脸数据集，包含：
- 180个不同的人脸类别（每个人一个文件夹）
- 每个类别包含多张不同姿态和表情的人脸图像
- 图像格式为.bmp格式

在运行程序时，系统会自动将每个类别的1张图像作为测试集，其余作为训练集。

## 结果输出

### 训练结果
- 训练过程中的损失值会实时显示在控制台
- 训练好的模型会保存为.pkl文件

### 测试结果
- 测试准确率会显示在控制台
- 详细的测试日志保存在`plots/test_log.txt`

### 可视化结果
- 训练过程中的损失曲线
- 不同模型的准确率比较图
- 结果图像保存在`results/plots/`目录

### 比较结果
- 不同模型性能的数值对比数据
- 比较结果保存在`results/comparison/`目录

## 注意事项
1. 确保数据集路径正确，且包含足够的人脸图像
2. 训练过程可能需要一定时间，取决于硬件性能
3. 如需调整模型参数以获得更好的性能，请修改相应的训练文件
4. 如遇中文显示问题，程序已内置字体设置，确保图表中的中文正常显示
5. 结果文件会自动保存在指定目录，无需手动创建

## 许可证
MIT License

## 致谢
感谢CASIA-FaceV5数据集的提供者，以及所有为机器学习和计算机视觉领域做出贡献的研究者和开发者。